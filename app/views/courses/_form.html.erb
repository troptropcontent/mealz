<div class="flex flex-col w-full bg-white mt-4">
    <div class="flex justify-between p-4">
        <p>Nouveau plat</p>
        <div class="bg-white flex justify-end">
            <%= link_to meal_path(meal) do %>
                <%= inline_svg_tag 'icons/x.svg' %>
            <% end %>
        </div>
    </div>
    <%= form_with model: course, class: "w-full bg-white flex flex-col px-4 pb-10" do |form| %>
        <%= form.fields_for :meal, meal do |meal_form| %>
            <%= meal_form.label :scheduled_on, "Date" %>
            <%= meal_form.text_field :scheduled_on, data: {
                controller: "flatpickr-classic",
                options: {enable: [{from: meal.event.start_on, to: meal.event.end_on}]}
            } %>
            <%= meal_form.label :kind, "Repas" %>
            <%= meal_form.select :kind, Meal.kinds.keys,{}, class: "mb-2"%>
        <% end %>
        <%= form.label :kind, "Type" %>
        <%= form.select :kind, Course.kinds.keys, {}, class: "mb-2"%>
        <%= form.label :name, "Nom du plat" %>
        <%= form.text_field :name %>
        <p>Composition</p>
        <hr class='border-t-2 border-black mb-2'>
        <div clas="flex flex-col">
            <% 10.times do |n| %>
                <%= render 'recipe_sub_form', course_form: form, index: n, recipe: recipes[n] || course.recipes.build %>
            <% end %>
        </div>
        <%= form.hidden_field :meal_id, value: meal.id %>
        <%= form.submit( 
            course.new_record? ? "Creer un plat" : "Modifier le plat" ,
            class: 'mt-4 bg-sky-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded' 
        )%>
    <% end %>
</div>

